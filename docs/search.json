{
  "articles": [
    {
      "path": "ANDEVA.html",
      "title": "Script ANDEVA de una via",
      "author": [],
      "contents": "\n\nContents\nR.1\nConceptos b√°sicos\ndel an√°lisis de la varianza\n\nC.1\nR.2\nR.3\nFin\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nR.1\nConceptos b√°sicos\ndel an√°lisis de la varianza\nLa hip√≥tesis nula en un an√°lisis de la varianza tipo I com√∫n es:\n\\[H0: m1 = m2 = m3 = ... = mk\\]\n¬øC√≥mo es que esta hip√≥tesis se pone a prueba en un ANDEVA? Por cierto\nesta es una prueba ‚Äúomnibus‚Äù, es decir ¬°prueba muchas cosas de un\njal√≥n!\nPara ver como es que opera el anova veamos el ejemplo que sigue:\nTomemos un solo factor, ‚Äúf‚Äù, con dos niveles y pongamos los datos en una\ngr√°fica simple, seg√∫n el orden en el que fueron obtenidas las\nmediciones.\n\n\nanova<-read.table(\"anova.data.txt\",header=T)\nattach(anova)\nnames(anova)\n\n\n\n\n\nplot(y)\nabline(mean(y), 0, col=4)\nfor (i in 1:length(y)) lines (c(i,i), c(mean(y), y[i]), col=5)\n\n\n\n\n¬øQu√© muestra esta gr√°fica? ¬øA que equivale la suma de los trazos\nverticales?\n\\[ SCT=\\Sigma(y-\n\\overline{y})^2\\]\nAhora vamos a hacer exactamente lo mismo, pero ahora dividiendo por\ncada uno de los niveles del factor F. Incorporemos la informaci√≥n del\nfactor ‚Äúf‚Äù. Para esto hay que calcular los promedios de ‚Äúy‚Äù que\ncorresponden a los niveles de ‚Äúf‚Äù\n\n\npromedios <- tapply(y, f, mean)\n\n\n\nGrafiquemos esta nueva estructura de datos sobre la gr√°fica que ya\ntenemos\n\n\nplot(y)\nlines(c(1, 7), c(promedios[1], promedios[1]), col = 2)\nlines(c(7, 14), c(promedios[2], promedios[2]), col = 5)\nfor (i in 1:7 ) lines (c(i,i), c(promedios[1], y[i]), col = 1, lty=6)\nfor (i in 8:14) lines (c(i,i), c(promedios[2], y[i]), col = 1, lty=6)\n\n\n\n\n¬øQu√© muestra esta gr√°fica? ¬øa que equivale la suma de los trazos\npunteados verticales?\n\\[SCE= \\Sigma(y_1-\\hat{y_1})^2 +\n\\Sigma(y_2- \\hat{y_2})^2\\]\nSi las dos medias fueran iguales ¬øc√≥mo comparar√≠an estas dos\ngr√°ficas?\nSi lo piensan tendr√≠an que ser iguales porque las medias de los\nniveles del tratamiento se nivelar√≠an a la misma altura. Si las medias\nson significativamente distintas ¬øcual varianza ser√≠a mayor? la\ncalculada con SCT o la calculada con SCE? Esta es la raz√≥n por la cual\nel ANDEVA compara medias a trav√©s de la comparaci√≥n de varianzas!!!!\n¬øQu√© interpretaci√≥n tiene la diferencia entre las dos sumas\nmencionadas arriba? Pues es precisamente la varianza explicada por el\nmodelo. Esta diferencia se asocia con la siguiente gr√°fica:\n\n\nmodelo <- lm(y~f)\nplot (y)\nabline (mean(y), 0, col = 4)\npoints(predict(modelo), pch = 16, col = 5)\nfor (i in 1:14) lines(c(i, i), c(mean(y), predict(modelo)[i]), col = 6)\n\n\n\n\nC.1\nR.2\n¬øQue implica el ajuste del modelo ANOVA del factor ‚Äúf‚Äù?\n\n\nSCT<-sum((y-mean(y))^2)\nSCT\n\n\n[1] 55.5\n\nLa pregunta es cuanto de esta variaci√≥n es explicada por diferencias\nentre las medias de A y B (niveles del factor F) y cuanto por el\nerror\n\n\nSCEa<-sum((y[f==\"a\"]-mean(y[f==\"a\"]))^2)\nSCEb<-sum((y[f==\"b\"]-mean(y[f==\"b\"]))^2)\n\n\n\nEntonces la SCE es la suma de estas dos cantidades\n\n\nSCE<-SCEa+SCEb\nSCE\n\n\n[1] 24\n\nFinalmente la SCA es SCT-SCE\n\n\nSCA<-SCT-SCE\nSCA\n\n\n[1] 31.5\n\nEntonces ya podemos llenar la tabla de ANOVA\n#C.2\nR.3\nAhora calculemos la F\n\n\n31.5/2\n\n\n[1] 15.75\n\ny la p\n\n\n1-pf(15.75,1,12)\n\n\n[1] 0.001864103\n\nAhora el automatico\n\n\nmodelo<-aov(y~f)\n\n\n\n\n\nsummary(modelo)\n\n\n            Df Sum Sq Mean Sq F value  Pr(>F)   \nf            1   31.5    31.5   15.75 0.00186 **\nResiduals   12   24.0     2.0                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nboxplot(y~f,xlab=\"factor F\",ylab=\"y\")\n\n\n\n\n¬øCual es la conclusi√≥n? Ahora hacemos la cr√≠tica del modelo\n\n\npar(mfrow=c(2,2))\nplot(modelo)\n\n\n\n\ny ahora lo ultimo\n\n\nA<-c(6,8,5,9,7,8,6)\nB<-c(9,11,8,12,10,11,9)\nt.test(A,B)\n\n\n\n    Welch Two Sample t-test\n\ndata:  A and B\nt = -3.9686, df = 12, p-value = 0.001864\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -4.647028 -1.352972\nsample estimates:\nmean of x mean of y \n        7        10 \n\nsummary(modelo)\n\n\n            Df Sum Sq Mean Sq F value  Pr(>F)   \nf            1   31.5    31.5   15.75 0.00186 **\nResiduals   12   24.0     2.0                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nLa anova es una ‚ÄúGeneralizaci√≥n‚Äù de t para poder comparar mas de dos\nmedias. En realidad F=t^2\nFin\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Correlacion.html",
      "title": "Script Correlaci√≥n",
      "author": [],
      "contents": "\n\nContents\nR.1\nFin\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nR.1\nVamos a ver una serie de datos para ver si existe una relaci√≥n lineal\nentre ellos.\n\n\ndata<-read.table(\"twosample.txt\",header=T)\nattach(data)\ndata\n\n\n\n\n\nplot(x,y)\n\n\n\n\nSe acuerdan que necesitamos primero para calcular el coeficiente de\ncorrelaci√≥n de pearson? Las varianzas individuales\n\n\nvar(x)\n\n\n[1] 199.9837\n\nvar(y)\n\n\n[1] 977.0153\n\n¬øy que m√°s? La covarianza y estamos hechos\n\n\nvar(x,y)\n\n\n[1] 414.9603\n\nAhora calculamos r\n\n\nvar(x,y)/sqrt(var(x)*var(y))\n\n\n[1] 0.9387684\n\nAhora hagamoslo en autom√°tico\n\n\ncor(x,y)\n\n\n[1] 0.9387684\n\nY ahora hagamos la prueba de hip√≥tesis\nCalculamos EE de r\n\n\nEEr<-((1-(cor(x,y)^2))/(length(x)-2))^0.5\nEEr\n\n\n[1] 0.05025759\n\nCalculo t de la muestra\n\n\nte<-cor(x,y)/EEr\nte\n\n\n[1] 18.67914\n\nCalculo t de tablas\n\n\nqt(0.975,47)\n\n\n[1] 2.011741\n\nCalculo la p\n\n\n2*(1-pt(18.67914,47))\n\n\n[1] 0\n\nAhora hagamoslo de manera autom√°tica\n\n\npearson<-cor.test(x,y)\npearson\n\n\n\n    Pearson's product-moment correlation\n\ndata:  x and y\nt = 18.679, df = 47, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8934139 0.9651786\nsample estimates:\n      cor \n0.9387684 \n\n¬øQue nos falta?. Pues no sabemos si cumplimos con los supuestos.\nVeamos el de normalidad\n\n\npar(mfrow=c(1,2))\nqqnorm(x, main=\"Q-Q plot x\"); qqline(x, col = 2, lty = 2)\nqqnorm(y, main=\"Q-Q plot y\"); qqline(y, col = 2, lty = 2)\n\n\n\n\n¬øQue opciones tengo?.\nHacer una prueba de sesgo y kurtosis para ver si estas\ndesviaciones son significativas\nSi son significativas, puedo intentar transformaciones o puedo\nutilizar muchas de las otras pruebas de correlaci√≥n que son robustas a\nla violaci√≥n de este supuesto. Vean Q y k p.76 y Crawley\np.97-102.\nFin\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Estimacion1.html",
      "title": "Script Estimaci√≥n 1 - El papel de la probabilidad",
      "author": [],
      "contents": "\r\n\r\nContents\r\nEl teorema de tendencia central\r\nR.1\r\nC.1\r\n\r\nR.2\r\nC.2\r\n\r\nR.3\r\nTarea de hoy\r\n¬°Fin!\r\n\r\n\r\n\r\n Descargar script\r\n\r\n\r\n\r\n\r\n Descargar script en pdf\r\n\r\n\r\nEl teorema de tendencia central\r\nR.1\r\nPid√°mosle a R que tome 10000 n√∫meros al azar (0-10) y que grafique con que frecuencia eligi√≥ cada n√∫mero ¬øque esperan ver?\r\n\r\n\r\nnumeros<-(runif(10000)*10)\r\n\r\n\r\n\r\n\r\nhist(runif(10000)*10,main=\"\")\r\n\r\n\r\n\r\nTomemos 5 n√∫meros al azar del 0 al 10 y saquemos el promedio de los cinco n√∫meros ¬øcual creen que sea el promedio t√≠pico? Hag√°monos\r\n\r\n\r\nclase<-c((mean(,,,,)), (mean(,,,,)))\r\nclase\r\n\r\n\r\nAhora pid√°mosle a R que lo haga 10000 veces (¬°10000 muestras de n√∫meros del 0 al 10!)\r\n\r\n\r\nmeans<-numeric(10000)\r\nfor (i in 0:10000){ \r\n  means[i]<- mean(runif(5)*10)}\r\n  \r\nhist(means,ylim=c(0,1600))\r\n\r\n\r\n\r\nNoten que existe una tendencia central. Lo que significa que el mero hecho de muestrear genera una tendencia central en el valor promedio.\r\nC.1\r\nR.2\r\nEl histograma de los n√∫meros se ve como una distribuci√≥n normal. ¬øporque no dibujamos una funci√≥n normal sobre este histograma para ver que tan normal es? ¬øQue necesitamos saber?\r\n\r\n\r\nmean(means)\r\n\r\n[1] 5.000557\r\n\r\nsd(means)\r\n\r\n[1] 1.298893\r\n\r\ny meterlo en la ecuaci√≥n\r\n\\[ f(y) = \\frac{1/}{(\\sqrt{2 \\pi} \\sigma)} e^{y- \\mu / 2 \\sigma^2} \\]\r\npara cada valor de means verdad? R lo hace por ustedes\r\nPrimero generamos una serie de n√∫meros para el eje x que le permita a R saber cada cuando poner un puntito de la l√≠nea. Si queremos una linea suave una buena regla es 100 n√∫meros. Como queremos n√∫meros entre 0 y 10:\r\n\r\n\r\nxv<-seq(0,10,0.1)\r\n\r\n\r\nComo la funci√≥n normal tiene un √°rea bajo la curva de 1 y nosotros tenemos 10000 valores, necesitamos escalar la curva multiplic√°ndola por el n√∫mero de valores que se encuentran de cada lado de el valor de en medio (mediana).\r\n\r\n\r\nyv<-dnorm(xv,mean=4.993275,sd=1.291482)*5000\r\n\r\n\r\n\r\n\r\nhist(means,ylim=c(0,1600))\r\nlines(xv,yv)\r\n\r\n\r\n\r\nEl ajuste es perfecto! Lo interesante del teorema de tendencia central es que no importa cual sea la distribuci√≥n real, si se toma una muestra de ella, se comportar√° normalmente.\r\nC.2\r\nR.3\r\nEl estandarizar la curva normal tiene muchas ventajas. Nos permite por ejemplo saber cual es el √°rea hasta cualquier valor del eje X (llamados desviaciones est√°ndar).\r\nPid√°mosle a R que nos dibuje una Distribuci√≥n Normal Estandarizada. Recuerden que lo primero que hay que hacer cuando se dibujan l√≠neas\r\n\r\n\r\nnd<-seq(-3,3,0.01)\r\n\r\n\r\nCuando no le damos la media y a la var, significa que queremos la estandarizada (el default), solo le dimos las x.\r\n\r\n\r\ny<-dnorm(nd)\r\nplot(nd,y,type=\"l\")\r\n\r\n\r\n\r\nAhora utilicemos pnorm para determinar que proporci√≥n de valores caen por debajo de dos desviaciones est√°ndar.\r\n\r\n\r\npnorm(-2)\r\n\r\n[1] 0.02275013\r\n\r\nque proporci√≥n? y ahora por debajo de 1 ds\r\n\r\n\r\npnorm(-1)\r\n\r\n[1] 0.1586553\r\n\r\n¬øQue pasa si queremos saber que proporci√≥n de muestras caen A LA DERECHA de la desviaci√≥n 3?\r\nesta es una opci√≥n\r\n\r\n\r\n 1-pnorm(3)\r\n\r\n[1] 0.001349898\r\n\r\n¬øy la otra?\r\n\r\n\r\npnorm(-3)\r\n\r\n[1] 0.001349898\r\n\r\nEs claro que un valor de 3 cuando la media es 0 en una dn es muy poco probable (0.13% de las veces cuando se saca una muestra de la pob.)\r\nAhora veamos un uso muy com√∫n de la distribuci√≥n de z. Este es preguntarse bajo una situaci√≥n aleatoria (solo por el hecho de muestrear una poblaci√≥n) entre que desviaciones est√°ndar podemos encontrar el 95% de las muestras. (noten que al ser sim√©trica, tenemos que alojar 2.5% de los casos ‚Äúexcedentes‚Äù de cada lado y para ello definimos un vector dentro de la funci√≥ qnorm (cuantiles normales)\r\n\r\n\r\nqnorm(c(0.025,0.975))\r\n\r\n[1] -1.959964  1.959964\r\n\r\nahora dibuj√©moslo\r\n\r\n\r\ny<-dnorm(nd)\r\n\r\nplot(nd,y,type=\"l\")\r\n  abline(v=-1.96)\r\n  abline(v=+1.96)\r\n\r\n\r\n\r\nEsto es muy importante porque si encontramos que nuestro muestreo no se ajusta a estos valores esperados entonces posiblemente pertenezcan a dos poblaciones distintas. Este es el principio b√°sico de todas las pruebas de significancia (p=0.05), el origen de el error est√°ndar (1.96 desv. est√°ndar), los l√≠mites de confianza etc.\r\nTarea de hoy\r\nSupongamos que tenemos una muestra de 100 colibr√≠es de una especie A. Les hemos medido la extensi√≥n de alas y encontramos que la media es 17 cm y la desviaci√≥n est√°ndar es de 0.8 cm.\r\nDibujen la distribuci√≥n de probabilidad bajo un supuesto de normalidad\r\n¬øque probabilidad hay de encontrar un caso con una extensi√≥n mayor a 18cm?\r\nNoten que cualquier valor de y en una distribuci√≥n normal se puede convertir en un valor de z. Recuerden que \\(z=(y-media(y))/desv.stand\\).\r\n¬øy la de encontrar un ave con una extensi√≥n menor a 15?\r\n¬øustedes creen que un ave con una extensi√≥n de 15cm puede decirse que con una confianza del 95% pertenece a la misma poblaci√≥n?\r\n¬øentre que medidas de extensi√≥n de alas se puede decir con un 95% de confianza que las aves pertenecen a esa poblaci√≥n?\r\n¬°Fin!\r\n\r\n\r\n\r\n",
      "last_modified": "2024-05-02T19:10:06-06:00"
    },
    {
      "path": "Estimacion2.html",
      "title": "Script Estimaci√≥n 2",
      "author": [],
      "contents": "\n\nContents\nR.1\nEstimaci√≥n de\npar√°metros de tendencia central\n\nC.1\nR.2\nC.2\nR.3\nMedidas de dispersi√≥n\nC.3\nR.4\nC.4\nR.5\nC.5\nR.6\nC.6\nFin ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar yvalues\n\n\nR.1\nEstimaci√≥n de\npar√°metros de tendencia central\nSabemos que aunque los datos no se agrupen alrededor de un valor\nt√≠pico si hacemos muestras consecutivas los estad√≠sticos de estas van a\ntener una tendencia central.\nVeamos un cuerpo de datos. Una variable y.\n\n\nyvals <- read.table(\"yvalues.txt\",header=T)\nattach(yvals)\nyvals\n\n\n\nUna manera muy simple de medir la tendencia central es ver cual es el\nvalor m√°s frecuente. Este se denomina MODA\n\n\nyord<-sort(y)\nyord\n\n\n [1] 1.029680 1.032829 1.037292 1.053150 1.053251 1.063707 1.064455\n [8] 1.070355 1.071217 1.075693 1.081053 1.084013 1.086288 1.094628\n[15] 1.095193 1.100543 1.101244 1.102617 1.104005 1.108847 1.108853\n[22] 1.109046 1.110171 1.112230 1.117421 1.120611 1.121111 1.126974\n[29] 1.127780 1.128891 1.130020 1.130521 1.134060 1.145682 1.149131\n[36] 1.150670 1.154751 1.156906 1.190229\n\n\n\n#windows()\nhist(y)\n\n\n\n\n¬øcual es la clase modal aqu√≠?\nPero ahora queremos saber la media aritm√©tica (el promedio) que es la\nsuma de todos los valores dividido por n.¬†¬øQue hago?\n\n\ntotal<-sum(y)\nsum(y)\n\n\n[1] 43.03511\n\npero ahora necesito saber cuantos valores son\n\n\nn<-length(y)\nn\n\n\n[1] 39\n\nmedia<- total/n\nmedia\n\n\n[1] 1.103464\n\npero ahora quiero tener una funci√≥n que me sirva para siempre\n\n\nmedia.aritmetica <- function(x) {\n  sum(x)/length(x) }\n\n\n\nya est√°, ahora prob√©mosla\n\n\ndata<-c(3,4,6,7)\nmedia.aritmetica(data)\n\n\n[1] 5\n\n\n\nmedia.aritmetica(y)\n\n\n[1] 1.103464\n\n¬°Que bien! ¬°R es fant√°stico! puedo calcular la media siempre que me\nplazca.\nEn realidad la mayor parte de las funciones estad√≠sticas est√°n ya\nconstruidas en R. Por supuesto que la media es una de ellas. Solo quer√≠a\nmostrarles que no hay nada obscuro detr√°s de los objetos ya creados en\nR\n\n\nmean(y)\n\n\n[1] 1.103464\n\nLa media como medida de tendencia central tiene el serio problema de\nque es muy sensible a valores at√≠picos. vean lo siguiente.\n\n\ndataat<-c(data,100)\ndataat\n\n\n[1]   3   4   6   7 100\n\nmean(dataat)\n\n\n[1] 24\n\ncomparado con\n\n\nmean(data)\n\n\n[1] 5\n\nUna alternativa es la mediana, que es el valor de en medio, una vez\nque todos los valores han sido ordenados. Veamos dataat\n\n\ndataat\n\n\n[1]   3   4   6   7 100\n\n¬øCual es la mediana?\n\n\nmedian(dataat)\n\n\n[1] 6\n\nes mucho mejor estimaci√≥n de el centro que 24.\n¬øy de data?\n\n\ndata\n\n\n[1] 3 4 6 7\n\n\n\nmedian(data)\n\n\n[1] 5\n\n¬ø y para y?\n\n\nmedian(y)\n\n\n[1] 1.108847\n\nmean(y)\n\n\n[1] 1.103464\n\nSe parecen mucho porque no hay valores at√≠picos y porque la\ndistribuci√≥n es sim√©trica.\nAhora pensemos en fen√≥menos que cambian multiplicativamente. ¬øConocen\nalguno?\nUno de los m√°s comunes en ecolog√≠a es el crecimiento poblacional y\npor lo tanto la dispersi√≥n de organismos de una poblaci√≥n. En dichos\ncasos la media aritm√©tica y/o la mediana suelen ser p√©simos estimadores\nde la tendencia central. Veamos un ejemplo.\nEl n√∫mero de insectos en una serie de plantas vecinas es\n\n\ninsectos<-c(1,10,1000,10,1)\n\n\n\n¬øCual es la mejor estimaci√≥n de tendencia central?\n\n\n#windows()\nhist(insectos)\n\n\n\n\n\n\nmean(insectos)\n\n\n[1] 204.4\n\nmedian(insectos)\n\n\n[1] 10\n\nC.1\nR.2\nLo que se usa es la media geom√©trica que si se acuerdan hay dos\nmaneras de calcularla. Para el ejemplo de los insectos ¬øcual es la mas\nsimple?\n\n\n100000^0.2\n\n\n[1] 10\n\n¬øy la otra?\n\n\nexp(mean(log(insectos)))\n\n\n[1] 10\n\n\n\ndetach(yvals)\nrm(insectos)\nls()\n\n\n[1] \"data\"             \"dataat\"           \"media\"           \n[4] \"media.aritmetica\" \"n\"                \"total\"           \n[7] \"yord\"             \"yvals\"           \n\nC.2\nR.3\nMedidas de dispersi√≥n\nVeamos un cuerpo de datos cualquiera y pregunt√©monos c√≥mo podemos\nmedir su dispersi√≥n.\n\n\ny<-c(13,7,5,12,9,15,6,11,9,7,12)\n\n\n\nveamos c√≥mo se ve\n\n\n#windows()\nplot(y,ylim=c(0,20))\n\n\n\n\nLo m√°s f√°cil es decir de donde a donde va (el intervalo).\n\n\nrange(y)\n\n\n[1]  5 15\n\nPero esto tiene sus problemas.\nNo tiene relaci√≥n con el par√°metro poblaci√≥n de intervalo.\nIncrementa con la n.\nAdem√°s es muy susceptible a valores at√≠picos\nNo considera a todos lo valores.\nOtra medida de dispersi√≥n muy importante es la varianza. Que est√°\nfundamentada en las desviaciones (o residuales) de cada valor con la\nmedia\n\n\ny<-c(13,7,5,12,9,15,6,11,9,7,12)\nplot(y,ylim=c(0,20))\nabline(mean(y),0)\nfor (i in 1:11) lines(c(i,i),c(y[i],mean(y)))\n\n\n\n\nse usa la suma de cuadrados de la diferencia de cada valor con la\nmedia general como base. ¬øC√≥mo lo calculamos?\n\n\ny-mean(y)\n\n\n [1]  3.3636364 -2.6363636 -4.6363636  2.3636364 -0.6363636  5.3636364\n [7] -3.6363636  1.3636364 -0.6363636 -2.6363636  2.3636364\n\n(y-mean(y))^2\n\n\n [1] 11.3140496  6.9504132 21.4958678  5.5867769  0.4049587 28.7685950\n [7] 13.2231405  1.8595041  0.4049587  6.9504132  5.5867769\n\nsum((y-mean(y))^2)\n\n\n[1] 102.5455\n\nFant√°sitico, pero que sucede a SC cada vez que yo adiciono una nueva\nobservaci√≥n. ¬øQue tenemos que hacer?\nSi divido entre n, se llama la desviaci√≥n media de los cuadrados.\nC.3\nR.4\n\n\nvariance <- function (x)   sum((x-mean(x))^2)/(length(x)-1)\nvariance(y)\n\n\n[1] 10.25455\n\nPero claro, ya est√° definido.\n\n\nvar(y)\n\n\n[1] 10.25455\n\nLa relaci√≥n entre la varianza de la muestra y el tama√±o de muestra\n(n)\nLo que vamos a hacer es seleccionar aleatoriamente n√∫meros de una\npoblaci√≥n que tiene una distribuci√≥n normal (media 10 y var 4). Esto lo\nvamos a hacer repetidas veces pero nuestra muestra va a ir incrementando\nsu n desde 3 hasta 31. Vamos a sacar 30 muestras de cada tama√±o de\nmuestra. Es decir 30 muestras de 3 n√∫meros, 30 muestras de 5 n√∫meros\netc. A cada muestra le vamos a calcular su varianza y las vamos a\ngraficar.\n\n\n# windows()\nplot(c(0,32),c(0,15),type=\"n\",xlab=\"Tama√±o de muestra\",ylab=\"Varianza\")\nfor (tm in seq(3,31,2)) {\nfor( i in 1:30){\nx<-rnorm(tm,mean=10,sd=2)\npoints(tm,var(x)) }}\n\n\n\n\nAhora pueden ver que la varianza poblacional puede estar muy mal\nestimada con tama√±os de muestra peque√±os. Y a medida que aumentamos el\ntama√±o de muestra la probabilidad de que la estimaci√≥n est√° muy lejos\ndel par√°metro disminuye. Esta es una raz√≥n m√°s para elegir muy\ncuidadosamente el tama√±o de muestra. En unas clases vamos a hablar de\nesto en el contexto de pruebas de hip√≥tesis.\nC.4\nR.5\nHagamos el mismo proceso que hicimos antes para elegir muestras con\ntama√±os de muestra que incrementan pero ahora veamos que sucede con\nnuestra medida de desconfianza de la estimaci√≥n a medida que aumenta\nn\n\n\n#windows()\nplot(c(0,32),c(0,2),type=\"n\",xlab=\"Tama√±o de muestra\",ylab=\"Error estandar\")\n for (tm in seq(3,31,2)) {\nfor( i in 1:30){\nx<-rnorm(tm,mean=10,sd=2)\npoints(tm,sqrt(var(x)/tm)) }}\n\n\n\n\nVeamos un ejemplo de la concentraci√≥n de ozono en unos\ninvernaderos\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar gardens\n\n\n\n\nozono<- read.table(\"gardens.txt\",header=T)\nattach(ozono)\nozono\n\n\n\n\n\n#windows()\npar(mfrow=c(1,3))\nplot (gardenA)\nplot (gardenB)\nplot (gardenC)\n\n\n\n\n\n\nMediaA<- mean(gardenA)\nEEA<- sqrt(var(gardenA)/10)\nMediaB<- mean(gardenB)\nEEB<- sqrt(var(gardenB)/10)\nMediaC<- mean(gardenC)\nEEC<- sqrt(var(gardenC)/10)\n\nMediaA\n\n\n[1] 3\n\nEEA\n\n\n[1] 0.3651484\n\nMediaB\n\n\n[1] 5\n\nEEB\n\n\n[1] 0.3651484\n\nMediaC\n\n\n[1] 5\n\nEEC\n\n\n[1] 1.19257\n\n¬øPara cual invernadero puedo yo confiar m√°s de la estimaci√≥n de la\nmedia?\nC.5\nR.6\nVamos a calcular los intervalos de confianza para la media de los\ninvernaderos usando la distribuci√≥n de t. qt nos d? el valor de t para\nel cual hay cierta proporci√≥n a la izquierda.\n\n\nqt(.975,9)\n\n\n[1] 2.262157\n\ncalculemos los intervalos de confianza al 95% para el invernadero\nB\n\n\nqt(.975,9)*sqrt(1.3333/10)\n\n\n[1] 0.8260127\n\nel reporte diario, la concentraci√≥n promedio de ozono en el\ninvernadero B fue de 5.0?0.826(I.C.95%, n=10)\n\n\n#windows()\nplot(gardenB)\nabline(mean(gardenB),0)\nabline((mean(gardenB)+0.826),0, lty=2)\nabline((mean(gardenB)-0.826),0, lty=2)\n\n\n\n\nlos dejo que ustedes calculen aquellos de los invernaderos A y C.\nC.6\nFin ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Estimacion2bis.html",
      "title": "Script estimacion 2_bis",
      "author": [],
      "contents": "\n\nContents\nIntervalos de confianza\nC.6\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nIntervalos de confianza\nExiste otra manera enteramente distinta de estimar intervalos de\nconfianza, y esta es enteramente autoreferida. Se usa el m√©todo de\nremuestreo o bootstrapping. Veamos un cuerpo de datos.\n\n\ndata<-read.table(\"skewdata.txt\",header=T)\nattach(data)\nnames(data)\n\n\n\nvamos a verlos visual y gr√°ficamente\n\n\nvalues\n\n\n [1] 81.372918 25.700971  4.942646 43.020853 81.690589 51.195236\n [7] 55.659909 15.153155 38.745780 12.610385 22.415094 18.355721\n[13] 38.081501 48.171135 18.462725 44.642251 25.391082 20.410874\n[19] 15.778187 19.351485 20.189991 27.795406 25.268600 20.177459\n[25] 15.196887 26.206537 19.190966 35.481161 28.094252 30.305922\n\n\n\nhist(values)\n\n\n\n\nAhora vamos a calcular los intervalos de confianza de remuestreo por\nquantiles a trav√©s de la funci√≥n sample que remuestrea y la funci√≥n\nquantile basados en la muestra. Ahora, la funci√≥n construida creo que no\nexiste, as√≠ que aqu√≠ la definimos.\n\n\nRemuestreo<-function(x){\na<-numeric(10000)\nfor (i in 1:10000){\na[i]<-mean(sample(x,30,replace=T))}\nquantile(a,c(.025,.975))}\nRemuestreo(values)\n\n\n    2.5%    97.5% \n24.89675 37.86573 \n\nVeamos como comparan con los IC normales\n\n\nmean(values)+1.96*sqrt(var(values)/30)\n\n\n[1] 37.53846\n\nmean(values)-1.96*sqrt(var(values)/30) \n\n\n[1] 24.39885\n\nVean ustedes porque elegimos 30 como una n buena para tama√±o de las\nmuestras repetidas\n\n\nplot(c(0,60),c(0,60),type=\"n\",xlab=\"Tama√±o de muestra\",ylab=\"IC remuestreo\")\n \nfor (k in seq(5,60,3)){\na<-numeric(10000)\nfor (i in 1:10000){\na[i]<-mean(sample(values,k,replace=T))\n}\npoints(c(k,k),quantile(a,c(.025,.975)),type=\"b\")\n}\n\n# Ahora veamos como comparan con los valores de IC normales\nxv<-seq(5,60,0.1)\nyv<-mean(values)+1.96*sqrt(var(values)/xv)\nlines(xv,yv)\nyv<-mean(values)-1.96*sqrt(var(values)/xv)\nlines(xv,yv)\n\n#y los valores de IC de t student \n\nyv<-mean(values)-qt(.975,xv)*sqrt(var(values)/xv)\nlines(xv,yv,lty=2)\nyv<-mean(values)+qt(.975,xv)*sqrt(var(values)/xv)\nlines(xv,yv,lty=2)\n\n\n\n\nNoten que no son exactamente sim√©tricos. Esto hace que sean\nligeramente sesgados. Existen otros dos m√©todos (por centiles y\nacelerados) que corrigen esto. Tambi√©n noten que para la distribuci√≥n de\nt son m√°s conservadores si el tama√±o de muestra es peque√±o.\nC.6\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Explor_ggplot.html",
      "title": "Script An√°lisis exploratorios_ versi√≥n ggplot",
      "author": [],
      "contents": "\n\nContents\nLibrer√≠as necesarias\nCargar datos\nBoxplots\nBoxplot\nb√°sico\nBoxplot\nggplot\n\nDotplots\nCon base R\nModo ggplot\n\nHistogramas\nBase R\nHistograma\nggplot\nHistograma de todos\n\nGr√°ficos de densidad\nggplot de una variable\nggplot de todas las\nvariables juntas\n\nQ-Q plots\nggplot de\nqqplots\n\n\n\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el csv donde van a trabajar\n\n\n Descargar datos\n\n\nLibrer√≠as necesarias\n\n\nlibrary(tidyverse) # Manejo de datos y ggplot\nlibrary(ggrepel) # generar los labels de los ggplots\nlibrary(ggridges) # Compara distribuciones n√∫mericas\nlibrary(patchwork) # Permite unir varios gr√°ficos de ggplot (tambi√©n noggplot pero requiere m√°s carpinteria)\n\n\n\nCargar datos\n\n\nairpoll<-source(\"chap2airpoll.dat\")$value\n\n\n\nBoxplots\nBoxplot b√°sico\n\n\nboxplot(airpoll$SO2, ylab=\"SO2\")\n\n\n\n\nBoxplot ggplot\nP√°ra hacer el gr√°fico necesitamos generar la base de datos en formato\n‚Äúlargo‚Äù\n\n\nairpoll2 <- stack(airpoll)\n\n\n\n\nvalues\nind\n36\nRainfall\n35\nRainfall\n44\nRainfall\n47\nRainfall\n43\nRainfall\n53\nRainfall\n\n\n\nfilter(airpoll2, ind == \"SO2\") %>% #selecciono variable que me importa\n  ggplot(aes(x= ind, y= values))+ # Creo la capa de datos\n  geom_boxplot(outlier.color = \"red\", #color de outlier\n               fill= \"gray\")+ # color de la caja\n#  geom_text(aes(label= values), position = position_dodge2(0.3))+\n  labs(title = \" Boxplot de SO2\",\n       y= \" Valores\",\n       x= \"\")+\n  theme_bw() # el tema que gustes\n\n\n\n\nM√°s complejo pero con m√°s cap√°cidad de edici√≥n\nAhora si queremos gr√°ficar todos los boxplors\nCon Base R es sencillo\n\n\nboxplot(airpoll)\n\n\n\nboxplot(log(airpoll+1)) # En escala log\n\n\n\n\nEn ggplot tenemos que usar la base de datos que tenemos en formato\n‚Äúlong‚Äù\n\n\nggplot(airpoll2, aes(x=ind, y= values, fill=ind))+\n  geom_boxplot(outlier.colour = \"red\")+\n  #geom_jitter()+ # agregar puntos\n  labs(title = \"Boxplot B√°sico\", x= \"\", y= \"valores\")+\n  theme_bw()+\n  theme(legend.position = \"none\") #quitar leyenda de variables\n\n\n\n\n\n\nggplot(airpoll2, aes(x=ind, y= log(values+1), fill=ind))+ #Ahora en log\n  geom_boxplot(outlier.colour = \"red\", notch = T)+\n  #geom_jitter()+ # agregar puntos\n  labs(title = \"Boxplot escala Log\", x= \"\", y= \"valores\")+\n  theme_bw()+\n  theme(legend.position = \"none\") #quitar leyenda de variables\n\n\n\n\nLos gr√°ficos de viol√≠n pueden ser √∫tiles tambi√©n\n\n\nggplot(airpoll2, aes(x=ind, y= log(values+1), fill=ind))+\n  geom_violin()+ # geometr√≠a de violin\n  geom_jitter(aes(col= ind), alpha= 0.6)+\n    labs(title = \"Gr√°fico de viol√≠n\", \n         x= \"\", y= \"variables scala log\")+\n  theme_minimal()+\n  theme(legend.position = \"none\") #quitar leyenda de variables\n\n\n\n\nAhora en conjunto\n\n\nggplot(airpoll2, aes(x=ind, y= log(values+1)))+\n  geom_jitter( aes(color=ind),width = 0.2, alpha= 0.6)+\n  geom_violin(aes(color=ind),\n              scale = \"width\", \n              alpha= 0.1, # valor de opacidad\n              size= 0.8)+ # tama√±o de la linea\n  geom_boxplot(width = 0.3, alpha= 0.1, size= 0.8,\n               outlier.color = \"red\",\n               outlier.alpha = 0.9,\n               outlier.size = 2)+\n  labs(title = \"Gr√°fico conjunto\", \n       x= \"\", y= \"Variables scala log\")+\n  theme_bw()+\n  theme(legend.position = \"none\", # quitar leyenda de variables\n       text = element_text(size= 11, face = \"bold\")) # Ajustar tama√±o de texto\n\n\n\n\nMuchas m√°s opciones en: https://www.r-graph-gallery.com/boxplot.html\nDotplots\nCon base R\n\n\ndotchart(airpoll$SO2, \n         ylab = \"Order of observations\", \n         xlab = \"SO2\", \n         main = \"Cleveland dotplot\")\n\n\n\n\nModo ggplot\n\n\nd_plot <-  airpoll %>% \n   mutate(index = seq(n())) %>%\n  select_if(is.numeric) %>% \n  pivot_longer(cols = !index, \n               names_to = \"Variable\", \n               values_to = \"Value\") %>%\n  ggplot(aes(x= Value, y= index, col= Variable))+\n  geom_point(size= 2, alpha=0.6)+\n  scale_color_viridis_d(option = \"mako\", \n                        begin = 0.1,\n                        end = 0.8)+\n  facet_wrap(~Variable, scales = \"free\")+\n  labs(y= \"Order of ovservation\")+\n   theme_bw()+\n   theme(legend.position = \"none\",\n         text = element_text(size=10))\n\n\n\nHistogramas\nBase R\n\n\nhist(airpoll$Rainfall,lwd=2)\n\n\n\n\nHistograma ggplot\n\n\nggplot(airpoll, aes(x=Rainfall))+\n  geom_histogram(bins =5, # n√∫mero de breaks\n                 fill= \"gray\", color= \"black\")+\n  labs(title= \"Histograma\",\n       y= \"Frequency\")+\n  theme_classic()\n\n\n\n\nHistograma de todos\nTenemos que usar de nuevo nuestra tabla en formato largo\n\n\nggplot(airpoll2, aes(x=values, fill= ind))+\n  geom_histogram( bins = 7, color=\"black\")+\n  facet_wrap(.~ind, scales = \"free\")+ # Crear los paneles por variable\n  theme_bw()+\n  theme(legend.position = \"none\")+\n  labs(x=\"\", y= \" Frequency\")\n\n\n\n\nMas opciones en https://www.r-graph-gallery.com/histogram.html\nGr√°ficos de densidad\nggplot de una variable\n\n\nggplot(airpoll, aes(x= Rainfall))+\n  geom_histogram(aes(y = stat(density)), \n                 bins = 7,\n                 fill= \"gray\",\n                 color=\"black\")+\n  geom_density(size=1)+\n  theme_classic()\n\n\n\n\nggplot de todas las\nvariables juntas\n\n\nggplot(airpoll2, aes(x=log(values+1), fill= ind))+\n  geom_histogram(aes(y = stat(density), fill= ind), \n                 bins = 7, color=\"black\")+\n  geom_density(aes(fill= ind),\n               size=1, alpha= 0.5)+\n  facet_wrap(.~ind, scales = \"free\")+ # Crear los paneles por variable\n  theme_classic()+\n  theme(legend.position = \"none\")+\n  labs(x=\"\", y= \" Frequency\")\n\n\n\n\nVariables a la misma escala con un gr√°fico de olas\n\n\nggplot(airpoll2, aes(x= log(values+1), y= ind, fill= ind))+\n  geom_density_ridges()+\n  theme_ridges() + \n  theme(legend.position = \"none\")\n\n\n\n\nQ-Q plots\nVoy a crear una base con una columna que tenga el nombre de las\nciudades\n\n\nairpoll3 <- airpoll %>% \n  rownames_to_column(var= \"City\")\n\n\n\n###plot base\n\n\nqqnorm(airpoll$Education, main=\"Q-Q plot Education\")\nqqline(airpoll$Education, col = 2, lty = 2)\n\n\n\n\nCon los labels\n\n\nEducation_plot <- qqnorm(airpoll3$Education, main=\"Q-Q plot Education\")\nqqline(airpoll3$Education, col = 2, lty = 2)\ntext(Education_plot[[1]], Education_plot[[2]], airpoll3$City, pos = 3,\n     cex = 0.7)\n\n\n\n\nggplot de qqplots\n\n\nggplot(airpoll3, aes(sample=Education))+\n  stat_qq()+\n  stat_qq_line(linetype= \"dashed\")+\n  geom_text_repel(label= airpoll3$City[order(airpoll3$Education)], \n                  stat = \"qq\",\n                  size= 1.5)+\n  labs(title = \"Q-Q plot\", \n       x= \"Theoretical Quantiles\", \n       y= \"Education sample cuantiles\")+\n  theme_bw()\n\n\n\n\nGr√°fico conjunto Necesito que mi base de datos este en formato largo\njunto con la columna de Ciudad\n\n\nairpoll4 <- airpoll %>% \n  rownames_to_column(var= \"City\") %>% # de nombres a columna\n  pivot_longer(cols = c(names(airpoll)), #Las columnas que bajo\n               names_to = \"variable\", # Nombre de la nueva column\n               values_to = \"valores\") # Nombre de col de valores\n\n\n\n\nCity\nvariable\nvalores\nakronOH\nRainfall\n36.0\nakronOH\nEducation\n11.4\nakronOH\nPopden\n3243.0\nakronOH\nNonwhite\n8.8\nakronOH\nNOX\n15.0\nakronOH\nSO2\n59.0\n\n\n\nggplot(airpoll4, mapping = aes(sample= valores,colour= variable))+\n  stat_qq()+\n  stat_qq_line()+\n  labs(title = \"QQplots\",\n       x= \"Theoretical Quantiles\", \n       y= \"Sample cuantiles\"\n  )+\n  facet_wrap(.~variable , scales = \"free\")+\n  theme_bw()\n\n\n\n\nGr√°ficos conjuntos se√±alando las ciudades Para este caso tube que\ncrear una funci√≥n que aplicara el label para cada qqplot\n\n\nf_ggplot <- function(x){\n  airpoll3 <- airpoll3\n  n <- names(airpoll3)\n  p1 <- ggplot(airpoll3, aes(sample=x))+\n    stat_qq()+\n    stat_qq_line()+\n    geom_text_repel(label= airpoll3$City[order(x)], \n                    stat = \"qq\",\n                    size= 1.5)+\n    labs(title = \"QQplot\", \n         x= \"Theoretical Quantiles\", \n         y= \"Sample Quantile\")+\n    theme_bw()\n}\n\n\n\n\n\nlabel_plots <- map(airpoll3, f_ggplot)\n\n(label_plots[[2]]+ ggtitle(paste(names(label_plots[2]), \"QQplot\")))+\n  (label_plots[[3]]+ ggtitle(paste(names(label_plots[3]), \"QQplot\")))+\n  (label_plots[[4]]+ ggtitle(paste(names(label_plots[4]), \"QQplot\")))+\n  (label_plots[[5]]+ ggtitle(paste(names(label_plots[5]), \"QQplot\")))+\n  (label_plots[[6]]+ ggtitle(paste(names(label_plots[6]), \"QQplot\")))+\n  (label_plots[[7]]+ ggtitle(paste(names(label_plots[7]), \"QQplot\")))+\n  (label_plots[[8]]+ ggtitle(paste(names(label_plots[8]), \"QQplot\")))\n\n\n\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Exploratorios.html",
      "title": "Script An√°lisis exploratorios",
      "author": [],
      "contents": "\n\nContents\nR.1\nExploraci√≥n Univariada\nBoxplot\nHistogramas\nKurtosis\ny simetr√≠a\nQQplots\n\n\nRelaciones bivariadas\nC.1\nR.2\nvalores faltantes\nFin\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el csv donde van a trabajar\n\n\n Descargar datos\n\n\nR.1\nESTE EJEMPLO ES DE DATOS DE EVERITT 04 P. 17. CONSISTE EN\nINFORMACI√ìN SOBRE CONTAMINACI√ìN AMBIENTAL EN EU EN ZONAS\nMETROPOLITANAS.\nLlamo los datos (ojo que Everitt los tiene en formato dat, si est√°n\ncomo txt, hay que llamarlos con read.table)\n\n\nairpoll<-source(\"chap2airpoll.dat\")$value\nap <- data.frame(airpoll)\n# write.csv(ap, \"apdf.csv\")\nadf <- read.csv(\"airpoll.csv\", header = T, sep = \";\") #tabla con dato faltante\n\n\n\n\n\nattach(airpoll)\nairpoll\n\n\n         Rainfall Education Popden Nonwhite NOX SO2 Mortality\nakronOH        36      11.4   3243      8.8  15  59     921.9\nalbanyNY       35      11.0   4281      3.5  10  39     997.9\nallenPA        44       9.8   4260      0.8   6  33     962.4\natlantGA       47      11.1   3125     27.1   8  24     982.3\nbaltimMD       43       9.6   6441     24.4  38 206    1071.0\nbirmhmAL       53      10.2   3325     38.5  32  72    1030.0\nbostonMA       43      12.1   4679      3.5  32  62     934.7\nbridgeCT       45      10.6   2140      5.3   4   4     899.5\nbufaloNY       36      10.5   6582      8.1  12  37    1002.0\ncantonOH       36      10.7   4213      6.7   7  20     912.3\nchatagTN       52       9.6   2302     22.2   8  27    1018.0\nchicagIL       33      10.9   6122     16.3  63 278    1025.0\ncinnciOH       40      10.2   4101     13.0  26 146     970.5\nclevelOH       35      11.1   3042     14.7  21  64     986.0\ncolombOH       37      11.9   4259     13.1   9  15     958.8\ndallasTX       35      11.8   1441     14.8   1   1     860.1\ndaytonOH       36      11.4   4029     12.4   4  16     936.2\ndenverCO       15      12.2   4824      4.7   8  28     871.8\ndetrotMI       31      10.8   4834     15.8  35 124     959.2\nflintMI        30      10.8   3694     13.1   4  11     941.2\nftwortTX       31      11.4   1844     11.5   1   1     891.7\ngrndraMI       31      10.9   3226      5.1   3  10     871.3\ngrnborNC       42      10.4   2269     22.7   3   5     971.1\nhartfdCT       43      11.5   2909      7.2   3  10     887.5\nhoustnTX       46      11.4   2647     21.0   5   1     952.5\nindianIN       39      11.4   4412     15.6   7  33     968.7\nkansasMO       35      12.0   3262     12.6   4   4     919.7\nlancasPA       43       9.5   3214      2.9   7  32     844.1\nlosangCA       11      12.1   4700      7.8 319 130     861.8\nlouisvKY       30       9.9   4474     13.1  37 193     989.3\nmemphsTN       50      10.4   3497     36.7  18  34    1006.0\nmiamiFL        60      11.5   4657     13.5   1   1     861.4\nmilwauWI       30      11.1   2934      5.8  23 125     929.2\nminnplMN       25      12.1   2095      2.0  11  26     857.6\nnashvlTN       45      10.1   2082     21.0  14  78     961.0\nnewhvnCT       46      11.3   3327      8.8   3   8     923.2\nneworlLA       54       9.7   3172     31.4  17   1    1113.0\nnewyrkNY       42      10.7   7462     11.3  26 108     994.6\nphiladPA       42      10.5   6092     17.5  32 161    1015.0\npittsbPA       36      10.6   3437      8.1  59 263     991.3\nportldOR       37      12.0   3387      3.6  21  44     894.0\nprovdcRI       42      10.1   3508      2.2   4  18     938.5\nreadngPA       41       9.6   4843      2.7  11  89     946.2\nrichmdVA       44      11.0   3768     28.6   9  48    1026.0\nrochtrNY       32      11.1   4355      5.0   4  18     874.3\nstlousMO       34       9.7   5160     17.2  15  68     953.6\nsandigCA       10      12.1   3033      5.9  66  20     839.7\nsanfrnCA       18      12.2   4253     13.7 171  86     911.7\nsanjosCA       13      12.2   2702      3.0  32   3     790.7\nseatleWA       35      12.2   3626      5.7   7  20     899.3\nspringMA       45      11.1   1883      3.4   4  20     904.2\nsyracuNY       38      11.4   4923      3.8   5  25     950.7\ntoledoOH       31      10.7   3249      9.5   7  25     972.5\nuticaNY        40      10.3   1671      2.5   2  11     912.2\nwashDC         41      12.3   5308     25.9  28 102     968.8\nwichtaKS       28      12.1   3665      7.5   2   1     823.8\nwilmtnDE       45      11.3   3152     12.1  11  42    1004.0\nworctrMA       45      11.1   3678      1.0   3   8     895.7\nyorkPA         42       9.0   9699      4.8   8  49     911.8\nyoungsOH       38      10.7   3451     11.7  13  39     954.4\n\nnames(airpoll)\n\n\n[1] \"Rainfall\"  \"Education\" \"Popden\"    \"Nonwhite\"  \"NOX\"      \n[6] \"SO2\"       \"Mortality\"\n\nExploraci√≥n Univariada\nComenzamos por ver el vector de medias y varianzas\n#mean(airpoll) #sd(airpoll)^2\n\n\nsummary(airpoll)\n\n\n    Rainfall       Education         Popden        Nonwhite    \n Min.   :10.00   Min.   : 9.00   Min.   :1441   Min.   : 0.80  \n 1st Qu.:32.75   1st Qu.:10.40   1st Qu.:3104   1st Qu.: 4.95  \n Median :38.00   Median :11.05   Median :3567   Median :10.40  \n Mean   :37.37   Mean   :10.97   Mean   :3866   Mean   :11.87  \n 3rd Qu.:43.25   3rd Qu.:11.50   3rd Qu.:4520   3rd Qu.:15.65  \n Max.   :60.00   Max.   :12.30   Max.   :9699   Max.   :38.50  \n      NOX              SO2           Mortality     \n Min.   :  1.00   Min.   :  1.00   Min.   : 790.7  \n 1st Qu.:  4.00   1st Qu.: 11.00   1st Qu.: 898.4  \n Median :  9.00   Median : 30.00   Median : 943.7  \n Mean   : 22.65   Mean   : 53.77   Mean   : 940.4  \n 3rd Qu.: 23.75   3rd Qu.: 69.00   3rd Qu.: 983.2  \n Max.   :319.00   Max.   :278.00   Max.   :1113.0  \n\n\n\nsummary(airpoll$SO2)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   1.00   11.00   30.00   53.77   69.00  278.00 \n\nvease la diferencia entre la media y la mediana para reconocer\ndesviaciones, calculese el intervalo intercuartiles (3er-1er).\nBoxplot\n\n\n#windows()\nboxplot(SO2, range=0, ylab=\"SO2\", main= \"Range 0\") # en este caso, los \"bigotes\" del boxplot ubican el m√°ximo (1) y el m√≠nimo (278).\n\n\n\n\n\nboxplot(SO2, ylab=\"SO2\", main= \"Range 1.5\") #en este caso, la funci√≥n se ejecuta con range = 1.5 por defecto.\n\n\n\n\n\n\n\n\niqSO2<-69-11\niqSO2\n\n\n[1] 58\n\nUna buena regla de dedo para identificar datos at√≠picos es: que los\npuntos que caen mas all√° del 3er+1.5(intercuartil) o mas bajo que\n1er-1.5(intercuartil) son valores at√≠picos.\n\n\natipicossup<-69+(iqSO2*1.5)\n  atipicossup\n\n\n[1] 156\n\n\n\natipicosinf<-abs(11-(iqSO2*1.5))\n  atipicosinf\n\n\n[1] 76\n\n\n\nhist(SO2,lwd=2)\nabline(v = 156, col = \"blue\")\n\n\n\n\n¬øCuales son los valores at√≠picos para SO2? Ahora veamos lo que\nconsidera R como at√≠picos por default\n\n\npar(mfrow=c(1,3))\nboxplot(SO2, range=0, ylab=\"SO2\", main= \"Range 0\")\nboxplot(SO2, ylab=\"SO2\", main=\"Por defecto\")\nboxplot(SO2, range=1.5, ylab=\"SO2\", main= \"Range = 1.5\")\n\n\n\n\nHistogramas\nVeamos las distribuciones de todas\n\n\npar(mfrow=c(3,3))\nhist(SO2,lwd=2); abline(v = c(53.77, 30), col = c(\"blue\", \"red\"))\nhist(Rainfall,lwd=2)\nhist(Education,lwd=2)\nhist(Popden,lwd=2)\nhist(Nonwhite,lwd=2)\nhist(NOX,lwd=2)\nhist(Mortality,lwd=2)\n\n\n\n\n¬øreconocen desviaciones negativas o positivas? Son normales?\nKurtosis y simetr√≠a\nEn este caso se necesita el paquete datawizard (Patil et al. 2022) para correr las\npruebas de kurtosis y simetria\nPara instalarlo pueden usar\n\n\ninstall.packages(\"datawizard\")\n\n\n\n¬øC√≥mo se ve sin sesgo y curtosis?\nSimetr√≠a (Skewness)\n\n\n\nlibrary(datawizard)\n\nnorm <- rnorm(1000) #Genero 1000 datos con distribuci√≥n normal\n\nsk <- skewness(norm)\nsk\n\n\nSkewness |    SE\n----------------\n   0.080 | 0.077\n\n\n\nku <- kurtosis(norm)\nku\n\n\nKurtosis |    SE\n----------------\n  -0.089 | 0.154\n\n\n\nhist(norm, freq = F)\nlines(density(norm))\ntext(x= -2, y=0.3, label= paste(\"Skewness =\", round(sk$Skewness,2))) \ntext(x= 2, y=0.3, label= paste(\"Kurtosis =\",  round(ku$Kurtosis,2)))\n\n\n\n\nAhora con nuestros datos\n\n\nskewness(SO2)\n\n\nSkewness |    SE\n----------------\n   1.912 | 0.301\n\nkurtosis(SO2)\n\n\nKurtosis |    SE\n----------------\n   3.552 | 0.559\n\n\n\nhist(SO2,freq = F)\nlines(density(SO2))\ntext(x= 100, y=0.01, label= \"Skewness = 1.912\")\ntext(x= 250, y=0.01, label= \"Kurtosis = 3.552\")\n\n\n\n\n\n\nskewness(log(SO2+1))\n\n\nSkewness |    SE\n----------------\n  -0.443 | 0.301\n\nkurtosis(log(SO2+1))\n\n\nKurtosis |    SE\n----------------\n  -0.390 | 0.559\n\n\n\nhist(log(SO2+1),freq = F)\nlines(density(log(SO2+1)))\ntext(x= 1, y=0.3, label= \"Skewness = -0.43\")\ntext(x= 5, y=0.3, label= \"Kurtosis = -0.45\")\n\n\n\n\n\n\nskewness(Mortality)\n\n\nSkewness |    SE\n----------------\n   0.096 | 0.301\n\nkurtosis(Mortality)\n\n\nKurtosis |    SE\n----------------\n   0.156 | 0.559\n\n\n\nhist(Mortality,freq = F)\nlines(density(Mortality))\ntext(x= 800, y=0.005, label= \"Skewness = 0.096\")\ntext(x= 1100, y=0.005, label= \"Kurtosis = 0.156\")\n\n\n\n\nQQplots\n\n\npar(mfrow=c(3,3))                                                 \nqqnorm(SO2, main=\"Q-Q plot SO2\"); qqline(SO2, col = 2, lty = 2)\nqqnorm(Rainfall, main=\"Q-Q plot Rainfall\"); qqline(Rainfall, col = 2, lty = 2)\nqqnorm(Education, main=\"Q-Q plot Education\"); qqline(Education, col = 2, lty = 2)\nqqnorm(Popden, main=\"Q-Q plot Popden\"); qqline(Popden, col = 2, lty = 2)\nqqnorm(Nonwhite, main=\"Q-Q plot Nonwhite\"); qqline(Nonwhite, col = 2, lty = 2)\nqqnorm(NOX, main=\"Q-Q plot NOX\"); qqline(NOX, col = 2, lty = 2)\nqqnorm(Mortality, main=\"Q-Q plot Mortality\"); qqline(Mortality, col = 2, lty = 2)\n\n\n\n\nRelaciones bivariadas\nVeamos que relaci√≥n hay entre las distintas variables. Aqu√≠ utilizo\nuna funci√≥n smoooth (regresi√≥n con pesos locales) que permite sugerir\ncon los propios datos que tipo de relaci√≥n pudieran tener.\n\n\npairs(airpoll, panel=panel.smooth)\n\n\n\n\nveamos con mas detalle la relaci√≥n SO2-mortalidad\n\n\nnombres<-abbreviate(row.names(airpoll))\npar(mfrow=c(1,1))\nplot(SO2,Mortality,lwd=2,type=\"n\")\ntext(SO2,Mortality,labels=nombres,lwd=2)\n\n\n\n\n\n\ndetach(airpoll)\n\n\n\nC.1\nR.2 valores faltantes\n\n\nairpoldf <- read.table(\"datofalta.txt\")\nairpoldf\nattach(airpoldf)\n\n\n\nLo mas f√°cil la media\n\n\nsummary(Mortality)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  789.7   892.4   943.7   936.6   977.1  1112.0       1 \n\n\n\nsum(is.na(Mortality))\n\n\n[1] 1\n\nCual es el valor imputado? Cuales son los problemas asociados a esta\nimputaci√≥n?\nregresi√≥n mortalidad y SO2\n\n\npar(mfrow=c(1,1)) \nplot(SO2,Mortality,lwd=2)\nabline(v = 59, h = 940.2)\nabline(v = 59, h = 921.9, col = \"red\")\n\n\n\n\n\n\nregmort<-lm(Mortality~SO2)\nsummary(regmort)\n\n\n\nCall:\nlm(formula = Mortality ~ SO2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-126.625  -38.213   -7.796   35.582  196.528 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 915.4721     9.4932  96.435  < 2e-16 ***\nSO2           0.4266     0.1177   3.624  0.00062 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 57.47 on 57 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.1872,    Adjusted R-squared:  0.173 \nF-statistic: 13.13 on 1 and 57 DF,  p-value: 0.0006196\n\nm <-  (915.4720997 + (0.4266209*59))  \n\n\n\n\n\npar(mfrow=c(1,1)) \nplot(SO2,Mortality,lwd=2)\nabline(v = 59, h = 940.2)\nabline(v = 59, h = 921.9, col = \"red\")\nabline(lm(Mortality~SO2))\n\n\n\n\n\n\npredict(regmort, list(SO2=58)) \n\n\n       1 \n940.2161 \n\n\n\nlogM<-log(Mortality)\nlogSO2<-log(SO2+7)\nloglog<-lm(logM~logSO2)\nsummary(loglog)\n\n\n\nCall:\nlm(formula = logM ~ logSO2)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.136793 -0.030759  0.000398  0.029763  0.212163 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 6.749926   0.021463 314.487  < 2e-16 ***\nlogSO2      0.026633   0.005928   4.493 3.48e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.05863 on 57 degrees of freedom\n  (1 observation deleted due to missingness)\nMultiple R-squared:  0.2615,    Adjusted R-squared:  0.2486 \nF-statistic: 20.19 on 1 and 57 DF,  p-value: 3.482e-05\n\n\n\npar(mfrow=c(1,2))\nplot(SO2,Mortality,lwd=2) \nabline(regmort)\nabline(v = 58, h = c(940.2161, 954.4211), col = \"red\")\n      \nplot(logSO2,logM,lwd=2) \nabline(lm(logM~logSO2))\nabline(v = 58, h = 940.2161, col = \"red\")\n\n\n\n\n\n\nplot(logSO2,logM,lwd=2) \nabline(lm(logM~logSO2))\n\n\n\n\nel valor de SO2 que corresponde al valor faltante de mortalidad es\n58. Como hemos generado un modelo de logaritmos a ambos lados de la\necuaci√≥n sacamos el log del (SO2+7)\n\n\nlog(58+7)\n\n\n[1] 4.174387\n\nUsamos la funci√≥n predict para predecir el valor correspondiente de\nMortalidad\n\n\npredict(loglog, list(logSO2=4.174387)) \n\n\n       1 \n6.861105 \n\npero recordando que usamos logaritmos en el modelo,\nretrotransformamos con el antilog con base e (e elevado al numero que\nnos interesa retro transformar)\n\n\nexp(6.861105)\n\n\n[1] 954.4211\n\nEl valor predicho por regresi√≥n lineal es? Cuales son los problemas\nasociados a esta imputaci√≥n?\nFin\n\n\n\nPatil, Indrajeet, Dominique Makowski, Mattan S. Ben-Shachar, Brenton M.\nWiernik, Etienne Bacher, and Daniel L√ºdecke. 2022.\n‚ÄúDatawizard: An\nr Package for Easy Data Preparation and\nStatistical Transformations‚Äù 7: 4684. https://doi.org/10.21105/joss.04684.\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "generaciones.html",
      "title": "Generaciones",
      "author": [],
      "contents": "\n\nContents\nCurso 2023\n\nCurso 2023\n\n\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "index.html",
      "title": "Introducci√≥n a la estad√≠stica inferencial",
      "description": "P√°gina del curso en su versi√≥n 2024\n",
      "author": [
        {
          "name": "Simoneta Negrete Yankelevich",
          "url": "https://www.researchgate.net/profile/Simoneta-Negrete-Yankelevich"
        },
        {
          "name": "Carlos Cultid Medina",
          "url": "https://www.researchgate.net/profile/Carlos-Cultid-Medina"
        },
        {
          "name": "Karen Lorena Vel√°squez-C",
          "url": "https://www.researchgate.net/profile/Karen-Velasquez-Carrillo?ev=hdr_xprf&_tp=eyJjb250ZXh0Ijp7ImZpcnN0UGFnZSI6InB1YmxpY2F0aW9uIiwicGFnZSI6ImhvbWUiLCJwb3NpdGlvbiI6Imdsb2JhbEhlYWRlciJ9fQ"
        },
        {
          "name": "Gabriel Andrade Ponce",
          "url": "https://www.researchgate.net/profile/Gabriel-Andrade-Ponce?ev=hdr_xprf"
        }
      ],
      "date": "05 02, 2024",
      "contents": "\r\n\r\nContents\r\n¬°Bienvenidos al curso! üëã\r\nCronograma del curso üìÜ\r\nMaterial de la clase üìö\r\nScripts de clase üìä\r\nAdicional\r\n\r\n\r\n¬°Bienvenidos al curso! üëã\r\nEste es la p√°gina del curso de Introducci√≥n a la estad√≠stica inferencial, versi√≥n 2024.\r\n\r\nCronograma del curso üìÜ\r\n\r\nMaterial de la clase üìö\r\nEl material del curso est√° disponible en la p√°gina de classroom, en las siguientes ligas\r\n√âl papel de la estad√≠stica en la investigaci√≥n\r\nIntroducci√≥n al Lenguaje R\r\nEstimaci√≥n 1 y 2\r\nAn√°lisis exploratorios\r\nPrueba de hip√≥tesis 1 y 2\r\nModelos lineales 1 y 2\r\nScripts de clase üìä\r\nLos scripts pueden ser visualizados en html en la parte superior derecha de esta p√°gina.\r\n\r\nRecuerden que las bases de datos se encuentran en el material de clase\r\nAdicional\r\nMonitor del curso 2024\r\nKaren Lorena Vel√°squez - C üìß karen.velasquez@posgrado.ecologia.edu.mx\r\nEdici√≥n de Scripts y p√°gina web: Gabriel Andrade Ponce - Karen Lorena Vel√°squez - C\r\nP√°gina hecha con la paqueter√≠a distill en RMarkdown.\r\n\r\n\r\n\r\n",
      "last_modified": "2024-05-05T22:54:05-06:00"
    },
    {
      "path": "links.html",
      "title": "Links de inter√©s",
      "author": [],
      "contents": "\nAqu√≠ encontrar√°n links a recursos de inter√©s para aprender sobre R,\nestad√≠stica y Ecolog√≠a.\n\n\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "PanelCorrel.html",
      "title": "Panel de correlaci√≥n",
      "author": [],
      "contents": "\n\nContents\nPerformance Analyticis\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì\nCorrplot\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-\nggcorrplot\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì\nGGally\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nPerformance Analyticis\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì\n\n\nairpoll<-source(\"chap2airpoll.dat\")$value\n\n\n\n\n\nlibrary(PerformanceAnalytics)\n\n\n\nchart.Correlation(log(airpoll+1),\n                  method=\"pearson\",\n                  histogram=TRUE,\n                  pch=20)\n\n\n\n\n?chart.Correlation\nCorrplot ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-\n\n\nlibrary(corrplot)\n\ncorr <- round(cor(log(airpoll+1), method = \"spearman\"),2)\ncor.mat <- cor.mtest(log(airpoll+1), conf.level = 0.95)\n\n\np1 <- corrplot(corr, method=\"color\",  \n         type=\"upper\", order=\"hclust\", \n         addCoef.col = \"black\", # Add coefficient of correlation\n         tl.col=\"black\", tl.srt=45, #Text label color and rotation\n         # Combine with significance\n         p.mat= cor.mat$p, sig.level = 0.01, insig = \"blank\", \n         # hide correlation coefficient on the principal diagonal\n         diag=FALSE \n)$corrPos      \ntext(p1$x, p1$y, round(p1$corr, 2))\n\n\n\n\nggcorrplot ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì\n\n\nlibrary(ggcorrplot)\n         \nggcorrplot(corr, \n           type = \"lower\",\n           lab = T, show.diag = F, \n           legend.title = \" Pearson\\nCorrelation\", \n           colors= c(\"#BB4444\", \"#FFFFFF\", \"#4477AA\"), \n           hc.order = T, \n           sig.level = 0.05, insig = \"pch\", pch=8, pch.cex = 2,  \n           p.mat= cor.mat$p, \n           ggtheme = ggplot2::theme(\n            panel.background = element_blank()))  \n\n\n\n\nGGally ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n\n\nlibrary(GGally)\n\npairs <- ggpairs(log(airpoll+1),\n        upper = list(continuous= wrap(\"cor\", method= \"pearson\", digits=2)),\n        lower = list( continuous= \"smooth\")) +theme_classic()\n\npairs\n\n\n\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Phdospob.html",
      "title": "Script Prueba de hip√≥tesis de dos poblaciones",
      "author": [],
      "contents": "\n\nContents\nR.3\nFin\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nR.3\nVolvamos al ejemplo de las concentraciones de ozono en los\ninvernaderos y vamos a preguntarnos si el promedio de sus\nconcentraciones de ozono es significativamente distinto\n\n\nozono<-read.table(\"gardens.txt\",header=T)\nattach(ozono)\nnames(ozono)\n\n\n\nVeamos un gr√°fico\n\n\nozonoAB<-c(gardenA,gardenB)\nozonoAB\n\n\n [1] 3 4 4 3 2 3 1 3 5 2 5 5 6 7 4 4 3 5 6 5\n\netiqueta<-factor(c(rep(\"A\",10),rep(\"B\",10)))\netiqueta\n\n\n [1] A A A A A A A A A A B B B B B B B B B B\nLevels: A B\n\n\n\nboxplot(ozonoAB~ etiqueta, notch=T,\n        xlab=\"Invernadero\",ylab=\"Ozono\")\n\n\n\n\nSi usamos el ojimetro, parece ser que no sus medianas no son\ndistintas porque los intervalos intercuartil no se sobrelapan. Ahora\nhagamos una prueba de t (para comparar las medias) a pie.\n¬øQue necesitamos?\nlos grados de libertad. dijimos que para una prueba de dos\npoblaciones calculamos el total de observaciones (20) menos el num. de\npar√°metros estimados antes de realizar la prueba (dos medias). As√≠ que\ntenemos 18 g.l.\nNecesitamos calcualar las varianzas individuales de cada\ninvernadero, para poder calcular la diferencia de EE.\n\n\ns2A<-var(gardenA)\ns2B<-var(gardenB)\n\n\n\n¬øLuego que sigue?\nCalculamos la t de student para la diferencia de medias\n\n\n(mean(gardenA)-mean(gardenB))/sqrt(s2A/10+s2B/10)\n\n\n[1] -3.872983\n\nNoten que podemos ignorar el signo de la t. Porque solo depende que\ncual media pusimos primero. El valor absoluto es lo que importa.\nAhora necesitamos el valor cr√≠tico de la distribuci√≥n de t de\nreferencia para determinar si aceptamos o rechazamos la hip√≥tesis de que\nno hay diferenicas entre medias (que vienen de la misma poblaci√≥n). Se\ntrata de un problema de una o dos colas?\nComo no me interesa cual es mayor o menor, ni tengo ninguna hip√≥tesis\nde que invernadero deb√≠a tener mas o menos ozono, entonces es de dos\ncolas, por lo tanto uso una probabilidad de?\n\n\nqt(0.975,18)\n\n\n[1] 2.100922\n\n¬øAcepto o rechazo la hip√≥tesis de que son iguales?\nEn virtud de que el valor calculado es mayor que el valor cr√≠tico se\nrechaza la hip√≥tesis nula. (recuerden m√°s alto=rechazo Ho m√°s\nbajo=acepto)\nFinalmente necesito saber cual es la probabilidad de que encuentre yo\nla diferencia entre estas dos muestras (o una m√°s extrema) a pesar de\nque provienen de poblaciones con la misma media. Recuerden que es un\nproblema de dos colas y por esa raz√≥n necesito calcular pt y despu√©s\nmultiplicarlos por dos (para los dos extremos).\n\n\np<-2*pt(-3.872983,18)\np\n\n\n[1] 0.00111454\n\npara calcular los intervalos de confianza para la diferencia\nmedias\n\n\ndifmed<-mean(gardenA)-mean(gardenB)\nEEdifmed<-sqrt(s2A/10+s2B/10)\nt.de.tablas.alfa.05.gl.18<-qt(0.975,18)\nt.de.tablas.alfa.05.gl.18\n\n\n[1] 2.100922\n\n\n\nIC95<-(EEdifmed)*(t.de.tablas.alfa.05.gl.18)\nCotasup<- difmed+IC95\nCotasup\n\n\n[1] -0.9150885\n\n\n\nCotainf<- difmed-IC95 \nCotainf\n\n\n[1] -3.084911\n\n\n\nIC95t<-(sqrt(s2A/10+s2B/10))*(qt(0.975,18))\n  IC95t\n\n\n[1] 1.084911\n\n¬øCual es la probabilidad de que suceda? Ahora el autom√°tico\n\n\npruebat<-t.test(gardenA,gardenB)\npruebat\n\n\n\n    Welch Two Sample t-test\n\ndata:  gardenA and gardenB\nt = -3.873, df = 18, p-value = 0.001115\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -3.0849115 -0.9150885\nsample estimates:\nmean of x mean of y \n        3         5 \n\nEntonces reporto la concentraci√≥n de ozono fue significativamente m√°s\nalta en el invernadero B (5.0 ppm) que en el A(3.0ppm;\nt=3.87, p=0.001(dos colas),\ngl=18)\nAhora, pudi√©ramos tener el problema de que las varianzas no son\niguales. entonces antes de hacer una prueba de t, necesitamos\npreguntarnos si las varianzas son significativamente distintas.\nComparemos las de los invernaderos B y C.\n\n\nvar(gardenB)\n\n\n[1] 1.333333\n\nvar(gardenC)\n\n\n[1] 14.22222\n\n¬øSe acuerdan que la distribuci√≥n de F era la adecuada para comparar\nvarianzas? la pregunta es, ¬øcual es la probabilidad de que estas dos\nmuestras hayan sido sacada de poblaciones que tienen la misma varianza?\nEl valor de F es simplemente el cociente de las varianzas\n\n\nCocienteF<-var(gardenC)/var(gardenB)\nCocienteF\n\n\n[1] 10.66667\n\nAhora comparo con la distribuci√≥n de probabilidad de F para los\ngrados de libertad correspondientes, y como no tengo ninguna idea de\ncual de las muestras debiera tener una varianza m√°s alta, entonces es\nuna prueba de dos colas.\nComo F no es sim√©trica, necesito calcular ambos lados.\n\n\nqf(0.975,9,9)\n\n\n[1] 4.025994\n\nqf(0.025,9,9)\n\n\n[1] 0.2483859\n\n¬øQue concluyo?\n¬øCual es la probabilidad de que estas dos muestras provengan de\npoblaciones con la misma varianza?\n\n\n2*(1-pf(CocienteF,9,9))\n\n\n[1] 0.001624199\n\nAhora el autom√°tico\n\n\nvar.test(gardenB,gardenC)\n\n\n\n    F test to compare two variances\n\ndata:  gardenB and gardenC\nF = 0.09375, num df = 9, denom df = 9, p-value = 0.001624\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.02328617 0.37743695\nsample estimates:\nratio of variances \n           0.09375 \n\nAhora, si encontr√°ramos que suponer que las poblaciones de las que\nprovienen las muestras no se distribuyen de manera normal entonces\ntenemos la alternativa de la prueba de Wilcoxon de suma de rangos. Esta\nes id√©ntica en su sistema a la de los rangos signados. Veamos como\nLo primero que hago es poner todas las observaciones en un mismo\nvector\n\n\nozone<-c(gardenA,gardenB)\nozone\n\n\n [1] 3 4 4 3 2 3 1 3 5 2 5 5 6 7 4 4 3 5 6 5\n\nAhora les hago sus etiquetas para que no se me pierdan\n\n\netiqueta<-c(rep(\"A\",10),rep(\"B\",10))\netiqueta\n\n\n [1] \"A\" \"A\" \"A\" \"A\" \"A\" \"A\" \"A\" \"A\" \"A\" \"A\" \"B\" \"B\" \"B\" \"B\" \"B\" \"B\"\n[17] \"B\" \"B\" \"B\" \"B\"\n\nAhora hago un vector de los rangos con la funci√≥n rank\n\n\nrangoscomb<-rank(ozone)\nrangoscomb\n\n\n [1]  6.0 10.5 10.5  6.0  2.5  6.0  1.0  6.0 15.0  2.5 15.0 15.0 18.5\n[14] 20.0 10.5 10.5  6.0 15.0 18.5 15.0\n\nNoten que para todos los valores repetidos se hace un promedio de los\nrangos que les tocan.\n\n\ntapply(rangoscomb,etiqueta,sum)\n\n\n  A   B \n 66 144 \n\nFinalmente uso el valor m√°s peque√±o (66) para compararlo con el valor\nde tablas para el etad√≠stico W para n de 10 y 10 y un alfa del 5%\n(W=78). Como nuestro valor es menor\n(porque uso como referencia el mas peque√±o del par que obtuve), entonces\nrechazo mi H0. Las Medias son significativamente distintas.\nAhora el autom√°tico.\n\n\nwilcox.test(gardenA,gardenB)\n\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  gardenA and gardenB\nW = 11, p-value = 0.002988\nalternative hypothesis: true location shift is not equal to 0\n\nLas diferencias se deben a que R utiliza un algoritmo de aproximaci√≥n\npara calcular valores de z. Es ligeramente distinto del tradicional que\nhicimos arriba. La mec√°nica es la misma. Noten la diferencia en las p de\nt y W. Wilcoxon es menos poderoso (95%). Pero es el correcto si las\ndistribuciones son sesgadas. Tambi√©n es correcto si no lo son (aunque\npoco menos poderoso). t no es correcta si hay desviaciones sustanciales\nde la normalidad.\nFin\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Phdospobbis.html",
      "title": "Script Prueba de hip√≥tesis de dos poblaciones-bis",
      "author": [],
      "contents": "\n\nContents\nR.3\nC.3\nTarea\nAqu√≠ va la segunda parte de su tarea\n\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nR.3\nEntonces ¬øcual es la probabilidad de que mi muestra de frecuencias (o una mas extrema) pertenezca a una poblaci√≥n donde el aislamiento de la planta y el plumaje del colibr√≠ defensor son independientes?\n\n\n1-pchisq(35.34,1)\n\n\n[1] 2.768866e-09\n\n¬øCual es el valor cr√≠tico para rechazar la H0 con un alfa de 0.05?\n\n\nqchisq(0.95,1)\n\n\n[1] 3.841459\n\nAhora vamos a hacerlo de manera autom√°tica en R\n\n\ncolibries<-matrix(c(38,14,11,51),nrow=2)\ncolibries\n\n\n     [,1] [,2]\n[1,]   38   11\n[2,]   14   51\n\nchisq.test(colibries)\n\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  colibries\nX-squared = 33.112, df = 1, p-value = 8.7e-09\n\nNoten que estos valores son un poco distintos porque se aplic√≥ una correcci√≥n de Yates. Esta fue dise√±ada para frecuencias peque√±as, pero ahora existen pruebas mejores para frecuencias peque√±as (20% o m√°s frecuencias menores a 5) como La Prueba exacta de Fisher Crawley p.¬†90 QyK p.388.\nEntonces le quito la correcci√≥n\n\n\nchisq.test(colibries,correct=F)\n\n\n\n    Pearson's Chi-squared test\n\ndata:  colibries\nX-squared = 35.334, df = 1, p-value = 2.778e-09\n\nme da exactamente lo que calculamos a mano.\nC.3\nTarea\nAqu√≠ va la segunda parte de su tarea\nEl problema se trata de un investigador que esta interesado en si las hormigas construyen preferentemente sus nidos en √°rboles de una de dos especies. Entonces muestre√≥ 100 √°rboles de cada una de las especies. Encontr√≥ que 60 √°rboles de la especie A y 20 de la especie B ten√≠an nidos. ¬øEsta muestra apoya la hip√≥tesis de preferencia?\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Phunapob.html",
      "title": "Script Prueba de hip√≥tesis de una poblacion",
      "author": [],
      "contents": "\n\nContents\nR.1\nC.1\nR.2\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nR.1\nVeamos un ejemplo de prueba de hip√≥tesis para una poblaci√≥n (Crawley\np.64). Estos son datos de Michelson (1978), de medidas tomadas para\nestimar la velocidad de la luz. Que ahora sabemos es cercano (299,990 km\np seg).\n\n\nveluz<-read.table(\"light.txt\",header=T)\nattach(veluz)\nnames(veluz)\n\n\n\n\n\nhist(speed)\n\n\n\n\n\n\nsummary(speed)\n\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n    650     850     940     909     980    1070 \n\nA todos los valores se les ha restado 299 000 para facilitar su\nvisualizaci√≥n ¬øque pueden ver aqu√≠? ¬øtenemos valores at√≠picos?\n\n\nboxplot(speed)\n\n\n\n\n\n\nqqnorm(speed)\nqqline(speed,lty=2)\n\n\n\n\nLa muestra no se distribuye de acuerdo a lo esperado normalmente\n(cosa que una prueba de t para una poblaci√≥n asume), pero adem√°s ¬øCreen\nque la poblaci√≥n de referencia se distribuya de manera normal?\nNo puede porque tiene el problema de que la vel de la luz no puede\ntomar valores negativos\nNuestra hip√≥tesis es que los datos de Michelson difieren de el valor\nprevaleciente en esa √©poca como la vel de la luz 299,990 km/seg. Como a\ntodos los valores les quitaron 299 000 entonces ¬øcual va a ser la\nreferencia?\nAhora, si cumpli√©ramos con el supuesto de que la pob. de referencia\nse distribuye normalmente, c√≥mo resolvemos este problema?‚Ä¶ustedes ya lo\nsaben hacer.\nPrimero. ¬øEste problema tiene una o dos colas que le pisen? Entonces\n¬øque har√≠an?\nBueno, pero como no cumplimos con el primero de los supuestos,\nnecesitamos otra alternativa. Que se les ocurre?\nPor supuesto que tambi√©n podemos usar una t√©cnica de remuestreo con\nremplazo! Este es el punto 1. de la tarea de hoy. Hagan la\nprueba con bootstrap\nExiste otra alternativa es una prueba llamada de rangos signados de\nWilcoxon.\nC.1\nR.2\n\n\nlibrary(stats)\n\nwilcox.test(speed,mu=990)\n\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  speed\nV = 22.5, p-value = 0.00213\nalternative hypothesis: true location is not equal to 990\n\nLa probabilidad de obtener la media de nuestra muestra (estad√≠stico)\nen una poblaci√≥n de las medias de muchas muestras con media 990\n(par√°metro) es del 0.2%. Como aceptamos una probabilidad de equivocarnos\nal rechazar una H0 cuando esta es cierta del 5% entonces, la\nrechazamos!\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Phunapobbis.html",
      "title": "Script Prueba de hip√≥tesis de una poblacion-bis",
      "author": [],
      "contents": "\n\nContents\nC.2\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece una\npantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nC.2\nVamos a escribir una funci√≥n para calcular sesgo.\n\n\nskew<-function(x){\nm3<-sum((x-mean(x))^3)/length(x)\ns3<-sqrt(var(x))^3\nm3/s3  }\n\n\n\nveamos los datos skewdata\n\n\ndata<-read.table(\"skewdata.txt\",header=T)\nattach(data)\nnames(data)\n\n\n\n\n\nhist(values)\n\n\n\n\nCalculemos el sesgo\n\n\nskew(values)\n\n\n[1] 1.318905\n\nAhora hagamos una prueba de t para determinar si hay sesgo respecto a\nlo esperado para una poblaci√≥n de inferencia con distribuci√≥n normal\n\n\nskew(values)/sqrt(6/length(values))\n\n\n[1] 2.949161\n\n1-pt(2.949,28)\n\n\n[1] 0.003185136\n\n¬øCual es la conclusi√≥n?. Efectivamente est√° m√°s sesgado de los\nesperado normalmente, ¬øque se puede hacer, si insistimos en cumplir con\nla normalidad?\n\n\nskew(sqrt(values))/sqrt(6/length(values))\n\n\n[1] 1.474851\n\nskew(log(values))/sqrt(6/length(values))\n\n\n[1] -0.6600605\n\n\n\nkurtosis<-function(x) {\nm4<-sum((x-mean(x))^4)/length(x)\ns4<-var(x)^2\nm4/s4 - 3  }\nkurtosis(values)\n\n\n[1] 1.297751\n\nkurtosis(values)/sqrt(24/length(values))\n\n\n[1] 1.45093\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Regresionsimp.html",
      "title": "Script Modelos lineales",
      "author": [],
      "contents": "\n\nContents\nR.1\nC.1\nR.2\nC.2\nR.3\nC.3\nR.4\nFin\n\n\n\n Descargar script\n\n\n\n\n Descargar script en pdf\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nR.1\nLlamo los datos, los coloco en un dataframe y convierto las columnas\nen variables\n\n\nreg.data<-read.table(\"tannin.txt\",header=T)\nattach(reg.data)\nnames(reg.data)\n\n\n\nGr√°fico\n\n\npar(mfrow=c(1,1))\nplot(tannin,growth,pch=16)\n\n\n\n\n¬øLa tendencia de la variable de respuesta es a incrementar o a\ndisminuir con la explicatoria? tendencia a disminuir\n¬øEs factible que los datos sean explicados por una l√≠nea horizontal?\nH0.\n\n\nplot(tannin,growth,pch=16)\nabline(mean(growth),0)\n\n\n\n\nLa H0 no parece factible, entonces b es probablemente dif de 0 y\nnegativa\n¬øSi existe una tendencia es recta o curva? relaci√≥n recta, entonces\nproponemos el modelo \\(y=a+bx+e\\)\n¬øLa dispersi√≥n de los datos es uniforme a lo largo de la l√≠nea o\ncambia sistem√°ticamente con la variable explicatoria?. Dispersi√≥n muy\nuniforme, la ordenada al origen es dif de 0 entonces a es prob mayor que\n0.\n¬øA ojo cuales son los valores de a y b? Como podemos hacer este\nproceso sistem√°tico y preciso?\nC.1\nR.2\nY la variaci√≥n total de y es la dispersi√≥n de los datos alrededor de\ny barra.\nLa Suma de Cuadrados Total es \\(SCT=\n\\sum(y-\\overline{y})^2\\)\n\n\nplot(tannin,growth,pch=16)\nabline(mean(growth),0)\nfor (i in 1:9) lines(c(tannin[i],tannin[i]),c(growth[i],mean(growth)))\n\n\n\n\nLa mejor recta ajustada por el m√©todo de m√≠nimos cuadrados es aquella\nque minimiza la Suma de Cuadrados de las desviaciones de los valores de\ny de la l√≠nea ajustada \\(\\hat{y}\\),\n\\(SCE=\\sum(y - \\hat{y})^2\\)\n\n\nplot(tannin,growth,pch=16) \nabline(lm(growth~tannin))\n\n\n\n\n\n\nysomb <- predict(lm(growth ~ tannin))\nplot(tannin,growth,pch=16) \nabline(lm(growth~tannin))\nfor(i in 1:9) lines(c(tannin[i], tannin[i]), c(growth[i], ysomb[i]))\n\n\n\n\nC.2\nR.3\nAhora bien, una tercera cantidad es la Suma de Cuadrados de la\nRegresi√≥n (es decir del efecto de la variable predictora)\n\\[SCR = SCTotal - SCError\\]\n\n\nplot(tannin, growth, type = \"n\") \nabline(mean(growth), 0) \nmodelito <- lm(growth ~ tannin) \nabline(modelito) \nfor(i in 1:9) lines(c(tannin[i], tannin[i]), c(mean(growth), predict(modelito)[i])) \npoints(tannin,predict(modelito), pch = 16) \npoints(tannin, growth)\n\n\n\n\nC.3\nR.4\nEmpezamos a ajustar los modelos: modelo nulo - solo la media\n\n\nNulo <- lm(growth ~ 1) \nnames(Nulo)\n\n\n [1] \"coefficients\"  \"residuals\"     \"effects\"       \"rank\"         \n [5] \"fitted.values\" \"assign\"        \"qr\"            \"df.residual\"  \n [9] \"call\"          \"terms\"         \"model\"        \n\n\n\nanova(Nulo) \n\n\nAnalysis of Variance Table\n\nResponse: growth\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals  8 108.89  13.611               \n\n\n\nNulo$df.residual \n\n\n[1] 8\n\nNulo$coefficients \n\n\n(Intercept) \n   6.888889 \n\nNulo$fitted.values\n\n\n       1        2        3        4        5        6        7 \n6.888889 6.888889 6.888889 6.888889 6.888889 6.888889 6.888889 \n       8        9 \n6.888889 6.888889 \n\n\n\nplot(tannin, growth) \nabline(a=Nulo$coe, b=0) \nabline(Nulo$coe, 0)\n\n\n\n\nEs decir solo se ha ajustado la media que no ofrece informaci√≥n\nimportante\nAgregamos el efecto del tannin\n\n\nTanino <- update(Nulo, . ~ . + tannin)\nTanino\n\n\n\nCall:\nlm(formula = growth ~ tannin)\n\nCoefficients:\n(Intercept)       tannin  \n     11.756       -1.217  \n\n\n\nanova(Tanino)\n\n\nAnalysis of Variance Table\n\nResponse: growth\n          Df Sum Sq Mean Sq F value    Pr(>F)    \ntannin     1 88.817  88.817  30.974 0.0008461 ***\nResiduals  7 20.072   2.867                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nTanino$coefficients\n\n\n(Intercept)      tannin \n  11.755556   -1.216667 \n\n\n\nsummary(Tanino)\n\n\n\nCall:\nlm(formula = growth ~ tannin)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.4556 -0.8889 -0.2389  0.9778  2.8944 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.7556     1.0408  11.295 9.54e-06 ***\ntannin       -1.2167     0.2186  -5.565 0.000846 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.693 on 7 degrees of freedom\nMultiple R-squared:  0.8157,    Adjusted R-squared:  0.7893 \nF-statistic: 30.97 on 1 and 7 DF,  p-value: 0.0008461\n\nO bien pedimos la secuencia de ajustes, que produce estos cambios en\ndevianza\n\n\nanova(Nulo, Tanino)\n\n\nAnalysis of Variance Table\n\nModel 1: growth ~ 1\nModel 2: growth ~ tannin\n  Res.Df     RSS Df Sum of Sq      F    Pr(>F)    \n1      8 108.889                                  \n2      7  20.072  1    88.817 30.974 0.0008461 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nsummary(Tanino)\n\n\n\nCall:\nlm(formula = growth ~ tannin)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.4556 -0.8889 -0.2389  0.9778  2.8944 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.7556     1.0408  11.295 9.54e-06 ***\ntannin       -1.2167     0.2186  -5.565 0.000846 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.693 on 7 degrees of freedom\nMultiple R-squared:  0.8157,    Adjusted R-squared:  0.7893 \nF-statistic: 30.97 on 1 and 7 DF,  p-value: 0.0008461\n\nSi queremos, podemos guardar los valores ajustados y los residuales\nen la base de datos:\n\n\nreg.data$ajustados <- fitted.values(Tanino) \nreg.data$residuales <- residuals(Tanino)\nreg.data\n\n\n  growth tannin ajustados residuales\n1     12      0 11.755556  0.2444444\n2     10      1 10.538889 -0.5388889\n3      8      2  9.322222 -1.3222222\n4     11      3  8.105556  2.8944444\n5      6      4  6.888889 -0.8888889\n6      7      5  5.672222  1.3277778\n7      2      6  4.455556 -2.4555556\n8      3      7  3.238889 -0.2388889\n9      3      8  2.022222  0.9777778\n\nPara inspeccionar qu√© tan bueno es el modelo existen algunos recursos\ngr√°ficos donde se examinan la distribuci√≥n de los residuales y los\npuntos extremos que que pueden ‚Äúcargar‚Äù el valor num√©rico de los\npar√°metros:\n\n\npar(mfcol=c(2,2))\nplot(Tanino)\n\n\n\n\nExtra\nUna funci√≥n muy interesante para evaluar un modelo es\ncheck_model del paquete performance(L√ºdecke et al. 2021). Recuerda que\npuedes instalarlo as√≠:\n\n\n# Debido a que performance requiere del paquete see para graficar, es bueno instalar ambos\ninstall.packages(c(\"performance\", \"see\"))\n\n\n\nCargamos las librerias\n\n\nlibrary(performance)\nlibrary(see)\n\n\n\nAhora usamos la funci√≥n\n\n\ncheck_model(Tanino)\n\n\n\n\nSi son fans de el diagn√≥stico num√©rico:\n\n\n# Por defecto usa los residuales estandarizados\ncheck_normality(Tanino)\n\n\nOK: residuals appear as normally distributed (p = 0.990).\n\nshapiro.test(rstandard(Tanino)) \n\n\n\n    Shapiro-Wilk normality test\n\ndata:  rstandard(Tanino)\nW = 0.98664, p-value = 0.9896\n\n\n\ncheck_heteroskedasticity(Tanino) # Breusch-Pagan test (1979).\n\n\nOK: Error variance appears to be homoscedastic (p = 0.843).\n\n\n\ncheck_outliers(Tanino)\n\n\nOK: No outliers detected.\n- Based on the following method and threshold: cook (0.77).\n- For variable: (Whole model)\n\nExaminamos un modelo sin el dato extremo:\n\n\nSindat7 <- lm(growth[-7] ~ tannin[-7]) \nsummary(Sindat7)\n\n\n\nCall:\nlm(formula = growth[-7] ~ tannin[-7])\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.4549 -0.9572 -0.1622  0.4572  2.6622 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.6892     0.8963  13.042 1.25e-05 ***\ntannin[-7]   -1.1171     0.1956  -5.712  0.00125 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.457 on 6 degrees of freedom\nMultiple R-squared:  0.8446,    Adjusted R-squared:  0.8188 \nF-statistic: 32.62 on 1 and 6 DF,  p-value: 0.001247\n\nNo ganamos gran cosa\nExtra\nPodemos obtener los resultados del modelo lineal en formato de\ndataframe con el paquete broom(Robinson,\nHayes, and Couch 2022) y la funci√≥n tidy\n\n\ninstall.packages(\"broom\")\n\n\n\n\n\nlibrary(broom)\ncoeftable <- tidy(Sindat7)\ncoeftable\n\n\n# A tibble: 2 x 5\n  term        estimate std.error statistic   p.value\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)    11.7      0.896     13.0  0.0000125\n2 tannin[-7]     -1.12     0.196     -5.71 0.00125  \n\nDe esta forma podemos reportarla de manera m√°s ordenada en un\ndocumento Rmarkdown, Quarto o simplemente guardarla como un csv para\nluego copiarla a mano en un documento word\nAs√≠ se puede guardar\n\n\nwrite.csv(coeftable, # objeto a guardar\n          file = \"modelo2.csv\") # nombre del archivo\n\n\n\nPara predecir valores usamos:\n\n\npredict(Tanino, list(tannin =7.5))\n\n\n       1 \n2.630556 \n\n\n\npar(mfrow=c(1,1)) \nls() \n\n\n[1] \"coeftable\" \"i\"         \"modelito\"  \"Nulo\"      \"reg.data\" \n[6] \"Sindat7\"   \"Tanino\"    \"ysomb\"    \n\nrm(list=ls(all=TRUE))\n\n\n\nFin\n\n\n\nL√ºdecke, Daniel, Mattan S. Ben-Shachar, Indrajeet Patil, Philip\nWaggoner, and Dominique Makowski. 2021.\n‚ÄúPerformance: An\nr Package for Assessment, Comparison and\nTesting of Statistical Models‚Äù 6: 3139. https://doi.org/10.21105/joss.03139.\n\n\nRobinson, David, Alex Hayes, and Simon Couch. 2022. ‚ÄúBroom:\nConvert Statistical Objects into Tidy Tibbles.‚Äù https://CRAN.R-project.org/package=broom.\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Tarea_1.html",
      "title": "Tarea 1",
      "author": [],
      "contents": "\n\nContents\nTeor√©ma de tendencia\ncentral\n\nTeor√©ma de tendencia central\nSupongamos que tenemos una muestra de 100 colibr√≠es de una especie A.\nLes hemos medido la extensi√≥n de alas y encontramos que la media es 17\ncm y la desviaci√≥n est√°ndar es de 0.8 cm.\nDibujen la distribuci√≥n de probabilidad bajo un supuesto de\nnormalidad\n¬øque probabilidad hay de encontrar un caso con una extensi√≥n\nmayor a 18cm?\nNoten que cualquier valor de y en una distribuci√≥n normal se puede\nconvertir en un valor de z. Recuerden que \\(z=(y-media(y))/desv.stand\\).\n¬øy la de encontrar un ave con una extensi√≥n menor a 15?\n¬øustedes creen que un ave con una extensi√≥n de 15cm puede decirse\nque con una confianza del 95% pertenece a la misma poblaci√≥n?\n¬øentre que medidas de extensi√≥n de alas se puede decir con un 95%\nde confianza que las aves pertenecen a esa poblaci√≥n?\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Tarea_2.html",
      "title": "Tarea 2",
      "author": [],
      "contents": "\n\nContents\nEstimaci√≥n\nPreguntas:\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nEstimaci√≥n\nLa tabla de datos de Palmer.xlsx contiene los Valores de\nImportancia (VI) de 25 especies de briofitas (musgos y l√≠quenes)\ncreciendo en troncos de √°rboles en tres sitios en el Duke Forest, en\nCarolina del Norte. Los VIs son una medida de abundancia relativa. Cada\nvalor (por celda) es el promedio de 10 √°rboles por sitio.\nLos c√≥digos de las muestras indican las especies de √°rbol:\nBN = Betula nigra, abedul;\nLT = Liriodendron tulipifera, √°rbol de tulip√°n;\nPE = Pinus echinata, pino de hoja chica;\nPO = Platanus occidentalis, ficus;\nPT = Pinus taeda, pino hoja mediana;\nQR= Quercus rubra, encino rojo;\nQA= Quercus alba, encino blanco.\nPreguntas:\n¬øCu√°l crees que sea la estimaci√≥n m√°s eficiente de la tendencia\ncentral para Isopterygium tenerum?\nEstima con un 93% de confianza en que intervalo se encuentra la\nmedia para 4 especies de briofitos (utilicen un m√©todo basado en\ndistribuciones y uno en remuestreo).\n¬øQu√© puedes decir para las distintas especies? ¬ødifieren las\nestimaciones dependiendo del m√©todo? ¬øPorqu√©?\n¬øC√≥mo reportar√≠as la media general para Platygyrium repens en un\nart√≠culo cient√≠fico?\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Tarea_3.html",
      "title": "Tarea 3",
      "author": [],
      "contents": "\n\nContents\nAn√°lisis Exploratorios\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nAn√°lisis Exploratorios\nLa tabla de datos de Palmer.csv contiene los valores de\nimportancia de 25 especies de briofitas (musgos y l√≠quenes) creciendo en\ntroncos de √°rboles en tres sitios en el Duke Forest, en Carolina del\nNorte. Los valores de importancia son una medida de abundancia relativa.\nCada muestra representa el promedio de 10 √°rboles en un sitio dado. Los\nc√≥digos de las muestras indican la especies de √°rbol y el sitio; BN =\nBetula nigra, abedul; LT = Liriodendron tulipifera, √°rbol de tulip√°n; PE\n= Pinus echinata, pino de hoja chica; PO = Platanus occidentalis, ficus;\nPT = Pinus taeda, pino hoja mediana; QR= Quercus rubra, encino rojo; QA=\nQuercus alba, encino blanco.\nPlantear una pregunta sencilla y examinar, a partir del\nexploratorio establecer si tengo la informaci√≥n suficiente para\ncontestar o no esa pregunta.\nRealizar un an√°lisis exploratorio completo de los datos. Usando\nlos datos de la tabla anterior.\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Tarea_4.html",
      "title": "Tarea 4",
      "author": [],
      "contents": "\n\nContents\nRemuestreo\nen pruebas de hip√≥tesis con una muestra simple\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nRemuestreo\nen pruebas de hip√≥tesis con una muestra simple\nEstos son datos de Michelson (1978) de medidas tomadas para estimar\nla velocidad de la luz que ahora sabemos es (299,792.458 km p seg).\nUse el cuerpo de datos contenidos en light.txt y\nutilizando el m√©todo de remuestreo calcule los intervalos de confianza\n(95%) de la media de la velocidad (speed). ¬øEl valor medio est√° dentro\ndel intervalo de confianza del muestreo?\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Tarea_5.html",
      "title": "Tarea 5",
      "author": [],
      "contents": "\n\nContents\nPrueba\nde hip√≥tesis\n\nPrueba de hip√≥tesis\nUn investigador est√° interesado en probar si las hormigas construyen\npreferentemente sus nidos en √°rboles de una de dos especies. Muestre√≥\n100 √°rboles de cada una de las especies y encontr√≥ que 60 √°rboles de la\nespecie A y 20 de la especie B ten√≠an nidos. ¬øEsta muestra apoya la\nhip√≥tesis de preferencia?\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "Tarea_6.html",
      "title": "Tarea 6",
      "author": [],
      "contents": "\n\nContents\nRegresi√≥n\nsimple\nRecuerda\n\n\nNOTA: Para descargar los datos, dar click en el boton. Aparece\nuna pantalla con los datos, luego dar click derecho y poner guardar como\n(save as). Guardar el txt donde van a trabajar\n\n\n Descargar datos\n\n\nRegresi√≥n simple\nLos datos de masas esquel√©ticas y corporales (todas en kg) del\narchivo pesoaves.txt fueron tomados al azar de un estudio\nm√°s amplio realizado por Prange, Anderson, and Rahn (1979) donde\nanalizaban la hip√≥tesis de que las aves tienen esqueletos m√°s ligeros\nque los mam√≠feros debido a su adaptaci√≥n al vuelo. Las dos primeras\ncolumnas correponden a masas de esqueleto y de cuerpo de aves\nrespectivamente. Las dos √∫ltimas columnas a masas esquel√©tica y\ncorporal, respectivamente, de mam√≠feros.\nEncuentra un modelo m√≠nimo adecuado que represente la relaci√≥n\nalom√©trica entre masa esquel√©tica y masa corporal para aves por un lado\ny para mam√≠feros por el otro. ¬øC√≥mo reportar√≠a los resultados obtenidos\nen un art√≠culo cient√≠fico?\nEstima con dichos modelos cu√°l ser√≠a la masa esquel√©tica esperada\npara un ave de 5 kg de masa corporal y cu√°l ser√≠a la masa esquel√©tica de\nun mam√≠fero de 5 kg.\nEn un an√°lisis cualitativo (por ejemplo sobreponiendo las curvas\npredichas) crees que se sostiene la hip√≥tesis de los autores?\nRecuerda\n‚Ä¢ Realizar el an√°lisis exploratorios (gr√°ficos y tablas)\npertinentes.\nEjecutar los an√°lisis en R, por favor incluye √∫nicamente las\nsalidas del programa que son ESTRICTAMENTE NECESARIAS\npara respaldar tus decisiones -\nEs IN√öTIL incluir en el reporte salidas del\nprograma SIN INTERPRETACI√ìN.\n\n\n\nPrange, Henry D., John F. Anderson, and Hermann Rahn. 1979.\n‚ÄúScaling of Skeletal Mass to Body Mass in Birds and\nMammals.‚Äù The American Naturalist 113 (1): 103‚Äì22. https://doi.org/10.1086/283367.\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    },
    {
      "path": "try.html",
      "title": "Videos Semana 2",
      "author": [],
      "contents": "\nhttps://drive.google.com/file/d/1J6ELC-oqQrsTNsTsSGfVGyV8iBELnJGG/view?usp=sharing\n\n\n\n\n",
      "last_modified": "2023-01-27T16:50:53-06:00"
    }
  ],
  "collections": []
}
